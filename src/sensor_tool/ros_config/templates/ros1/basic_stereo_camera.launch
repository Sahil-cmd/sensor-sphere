<launch>
    <!-- {sensor_description} -->
    <!-- Generated by Sensor Comparison Tool -->

    <!-- Sensor Configuration -->
    <arg name="sensor_serial" default="" />
    <arg name="sensor_name" default="{sensor_id}" />
    <arg name="left_width" default="{rgb_width}" />
    <arg name="left_height" default="{rgb_height}" />
    <arg name="right_width" default="{rgb_width}" />
    <arg name="right_height" default="{rgb_height}" />
    <arg name="depth_width" default="{depth_width}" />
    <arg name="depth_height" default="{depth_height}" />
    <arg name="fps" default="{frame_rate}" />

    <!-- Connection Settings -->
    <arg name="connection_type" default="{connection_type}" />

    <!-- Range Settings -->
    <arg name="min_depth" default="{min_range}" />
    <arg name="max_depth" default="{max_range}" />

    <!-- Stereo Settings -->
    <arg name="baseline" default="0.12" />  <!-- meters, typical stereo baseline -->
    <arg name="enable_stereo_rectification" default="true" />
    <arg name="enable_depth_from_stereo" default="true" />

    <!-- Advanced Settings -->
    <arg name="enable_left" default="true" />
    <arg name="enable_right" default="true" />
    <arg name="enable_depth" default="true" />
    <arg name="enable_pointcloud" default="false" />
    <arg name="enable_imu" default="false" />

    <!-- TF Settings -->
    <arg name="publish_tf" default="true" />
    <arg name="tf_prefix" default="$(arg sensor_name)" />
    <arg name="base_frame" default="$(arg tf_prefix)_link" />
    <arg name="left_frame" default="$(arg tf_prefix)_left_optical_frame" />
    <arg name="right_frame" default="$(arg tf_prefix)_right_optical_frame" />
    <arg name="depth_frame" default="$(arg tf_prefix)_depth_optical_frame" />

    <!-- Driver Node -->
    <group ns="$(arg sensor_name)">
        <include file="{driver_include_file}">
            <arg name="serial_no" value="$(arg sensor_serial)" />
            <arg name="resolution_width" value="$(arg left_width)" />
            <arg name="resolution_height" value="$(arg left_height)" />
            <arg name="frame_rate" value="$(arg fps)" />
            <arg name="depth_fps" value="$(arg fps)" />
            <arg name="depth_stabilization" value="1" />
            <arg name="enable_pointcloud" value="$(arg enable_pointcloud)" />
            <arg name="enable_imu" value="$(arg enable_imu)" />
            <arg name="publish_tf" value="$(arg publish_tf)" />
            <arg name="base_frame" value="$(arg base_frame)" />
            <arg name="depth_frame" value="$(arg depth_frame)" />
            <arg name="left_camera_frame" value="$(arg left_frame)" />
            <arg name="right_camera_frame" value="$(arg right_frame)" />
        </include>
    </group>

    <!-- Stereo Processing (Optional) -->
    <group ns="$(arg sensor_name)" if="$(arg enable_stereo_rectification)">
        <node pkg="stereo_image_proc" type="stereo_image_proc" name="stereo_image_proc">
            <remap from="left/image_raw" to="left/image_rect_color" />
            <remap from="right/image_raw" to="right/image_rect_color" />
            <remap from="left/camera_info" to="left/camera_info" />
            <remap from="right/camera_info" to="right/camera_info" />
        </node>
    </group>

    <!-- Optional: Static Transform Publisher for sensor mount -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="$(arg sensor_name)_mount_publisher"
          args="0 0 0 0 0 0 1 world $(arg base_frame)" if="$(arg publish_tf)" />

</launch>
